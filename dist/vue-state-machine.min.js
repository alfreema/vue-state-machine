!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("xstate")):"function"==typeof define&&define.amd?define(["xstate"],t):e.vsm=t(e.xstate)}(this,function(e){"use strict";var t={namespaced:!0,state:{machineName:null,currentState:null,machines:{}},getters:{},mutations:{SET_CURRENT_STATE:function(e,t){e.currentState=t.currentState},SET_MACHINE:function(e,t){e.machineName=t.machineName,e.currentState=e.machines[t.machineName].currentState},ADD_MACHINE:function(e,t){e.machines[t.machineName]=t.machine}},actions:{setCurrentState:function(e,t){console.log("vsm-store:actions:setCurrentState():currentState="+t.currentState),e.commit({type:"SET_CURRENT_STATE",currentState:t.currentState.value})},setMachine:function(e,t){console.log("vsm-store:actions:setMachine():machineName="+t.machineName),!1!==e.state.machines.hasOwnProperty(t.machineName)?e.commit({type:"SET_MACHINE",machineName:t.machineName}):console.error("vsm: machine is not found. Please check the machine name:",t.machineName)},addMachine:function(e,t){console.log("vsm-store:actions:addMachine():machineName="+t.machineName+":machine="+t.machine),t.machine.currentState=t.machine.initial,console.log("vsm-store:actions:addMachine():currentState="+t.machine.currentState),e.commit({type:"ADD_MACHINE",machineName:t.machineName,machine:t.machine})}}},n={install:function(n,a,i){var c=Object.assign({moduleName:"vsm"},i).moduleName;if(a.registerModule(c,t),!1!==a.state.hasOwnProperty(c)){var o=function(e){var t=arguments,n="",i={};t.length>0&&(n=t[1]),t.length>1&&(i=t[2]),console.log("vsm-plugin:transitionMachine():begin:currentState="+e+":type="+n+":params="+i);var o=a.state[c].machineName;console.log("vsm-plugin:transitionMachine():machineName="+o);var s=a.state[c].machines[o];console.log("vsm-plugin:transitionMachine():machine="+s);var m=s.transition(e,n);console.log("vsm-plugin:transitionMachine():nextState="+m),a.dispatch({type:c+"/setCurrentState",currentState:m}),m.actions.forEach(function(e){a.dispatch(o+"/"+e,{type:n,params:i,history:m.history})})};n.prototype.$vsm={transition:function(){console.log("vsm-plugin:transition():begin");var e=a.state[c].currentState;return o.apply(void 0,[e].concat(Array.prototype.slice.call(arguments)))},set:function(e){a.dispatch({type:c+"/setMachine",machineName:e})},add:function(t,n){return console.log("vsm-plugin:addMachine():storeName="+t),a.dispatch({type:c+"/addMachine",machineName:t,machine:e.Machine(n)})}}}else console.error("vsm: vsm vuex module is not correctly initialized. Please check the module name:",c)}};return{store:t,plugin:n}});